% © 2025 Daniel P. Madden — Custodial Author
% AI OSI Stack v5.0-open-core (Civic Standard Edition)

% © 2025 Daniel P. Madden. Custodial Edition – AI OSI Stack v5.0-open-core.
% Unauthorized reproductions or derivatives are not recognized custodial works.
% Refer to CANONICAL_PROVENANCE.yaml for official verification.
% SPDX-License-Identifier: CC-BY-SA-4.0

% AI OSI Stack v5 — Canonical Edition
% Appendix F — AEIP Schema Set (v1.3)
\narrative{
Appendix F presents the Assurance Evidence Integration Protocol (AEIP) as the canonical evidence spine for the Stack. The narrative
returns to operations engineer Lin and civic archivist Priyanka, now walking through the schema registry room restored from
version~4. They trace how every "\shall{}" clause binds to a specific schema, how custodial signatures seal each record, and how the
manifest orchestrates deterministic field ordering. The annex emphasises that AEIP is not a library of templates but a living
protocol: manifests, instruction logs, model cards, civic charters, and participation receipts form an interoperable chain that can
be re-verified from first principles.
}

\narrative{
Lin demonstrates the AEIP Frame outline. Field order is fixed—\texttt{canonical\_metadata}, \texttt{subject}, \texttt{temporal\_seal},
\texttt{witnesses}, \texttt{evidence\_hashes}, and \texttt{custodian\_signatures}. Priyanka highlights the hash algorithm (SHA-512) and the
signing suite (Ed25519 canonical keys). When a new artefact enters the stack, custodians instantiate the AEIP Frame, map the
specialised payload (e.g., modelcard or incident report), and sign the bundle. Appendix~F publishes the full schemas, the registry
table with checksums, and an illustrative deterministic ordering snippet so practitioners can script the same validation sequence.
}

% Rationale: Make cryptographic handling optional-but-recommended while preserving provenance duties.
% [SYNTHESIZED v5 PH1+]
\normative{
AEIP custodians \shall{use the canonical field order defined in \texttt{schemas/aeip/aeip-frame-schema.json}}. Hashes \should{be computed
with SHA-512 over UTF-8 normalised bytes as the recommended verification pathway}, recorded in \texttt{evidence\_hashes[*].value}, and
validated against manifest entries when produced. Witnesses \shall{include role, jurisdiction, and verification channel}, ensuring that
Appendix~O provenance audits can confirm custodial continuity. Deviations \shall{be documented in Appendix~L ledgers with remediation
deadlines}. No artefact \may{enter production without a complete AEIP Frame accompanied by signed custody metadata}; signature generation is
optional but recommended for public attestations and \should{follow the canonical key guidance when used}.
}

\normative{
Schema evolution \shall{follow the registry workflow captured below}. Release managers \shall{bump manifest entries, regenerate the
schema registry table, and publish new checksums in Appendix~N}. Operations teams \should{run regression validators against every
schema listed in this appendix before ratifying a revision}. Civic observers \may{reproduce the verification procedure} by fetching the
manifest, running the deterministic ordering script, and comparing published hashes with locally computed values.
}

\begin{quote}
\textbf{Deterministic Ordering Example.} AEIP frame ordering is preserved by serialising YAML keys exactly as shown below. Scripts
that alter key order or introduce additional whitespace invalidate signatures and \shall{trigger rejection alerts}.\end{quote}

% Rationale: Provide an illustrative AEIP Frame ordering snippet for verification tooling.
% [SYNTHESIZED v5 PH1+]
\begin{lstlisting}[language=yaml,caption={AEIP Frame deterministic order example}]
canonical_metadata:
  aeip_version: "1.3"
  canonical_version: "AI OSI Stack v5.0.0"
subject:
  schema: "aeip/modelcard"
  reference_id: "MC-2025-0041"
temporal_seal:
  created_at: "2025-11-09T18:03:12Z"
  jurisdiction: "Ward 7"
witnesses:
  - role: "custodian"
    name: "Lin Okafor"
    verification_channel: "https://records.example.gov/aeip"
evidence_hashes:
  - algorithm: "sha512"
    value: "<hex-digest>"
custodian_signatures:
  - signer: "stack-custodian-ed25519"
    signature: "<base64>"
\end{lstlisting}

\input{appendices/generated/appendix-f-schema-registry}

% Rationale: Clarify that checksum validation remains optional yet traceable for verifiers.
% [SYNTHESIZED v5 PH1+]
\normative{
AEIP schema listings \shall{be treated as normative artefacts}. Any institution claiming conformance \should{reference the published checksum}
from the registry table as an optional verification aid. Custodians \should{store verification logs documenting checksum validation when
performed}. Oversight actors \should{sample schema listings during audits} and \may{publish independent hashes to Appendix~N}. Implementation
guides \shall{note the schema path, version, and validation command} for every operational playbook so optional verification remains
reproducible.
}